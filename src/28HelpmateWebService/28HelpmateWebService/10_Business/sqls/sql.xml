<?xml version="1.0" encoding="utf-8" ?>
<Sqls>
  <sql name="UpdateOmission">
    <![CDATA[
    exec RefreshOmitStatistics :GameSysNo :SourceSysNo :SiteSysNo
    ]]>
  </sql>
  <sql name="QueryOmissionAllForBJ">
    <![CDATA[
DECLARE @MAX_P INT
SELECT @MAX_P=MAX(PeriodNum) FROM dbo.SourceData_28_Beijing
SELECT MAX(PeriodNum) AS NearPeriod
        ,MAX(RetNum) AS [Number]
        ,(@MAX_P-MAX(PeriodNum)) AS [Interval]
FROM dbo.SourceData_28_Beijing
GROUP BY RetNum
    ]]>
  </sql>
  <sql name="QueryTrend2">
    <![CDATA[

(
SELECT RC.BigOrSmall AS Name
      ,COUNT(RC.BigOrSmall) AS Total
      
FROM dbo.SourceData_28_Beijing BJ
	INNER JOIN dbo.ResultCategory_28 RC
		ON BJ.RetNum=RC.RetNum
	INNER JOIN DBO.UseSite US
    ON BJ.SiteSysNo=US.SysNo
WHERE BJ.RetTime BETWEEN :START_DATE AND :END_DATE
	AND US.SysNo=:SiteSysNo
GROUP BY RC.BigOrSmall
)
union
(
SELECT RC.MiddleOrSide AS Name
      ,COUNT(RC.MiddleOrSide) AS Total
      
FROM dbo.SourceData_28_Beijing BJ
	INNER JOIN dbo.ResultCategory_28 RC
		ON BJ.RetNum=RC.RetNum
		INNER JOIN DBO.UseSite US
    ON BJ.SiteSysNo=US.SysNo
WHERE BJ.RetTime BETWEEN :START_DATE AND :END_DATE
AND US.SysNo=:SiteSysNo
GROUP BY RC.MiddleOrSide
)
union
(
SELECT RC.OddOrDual AS Name
      ,COUNT(RC.OddOrDual) AS Total
      
FROM dbo.SourceData_28_Beijing BJ
	INNER JOIN dbo.ResultCategory_28 RC
		ON BJ.RetNum=RC.RetNum
		INNER JOIN DBO.UseSite US
    ON BJ.SiteSysNo=US.SysNo
WHERE BJ.RetTime BETWEEN :START_DATE AND :END_DATE
AND US.SysNo=:SiteSysNo
GROUP BY RC.OddOrDual
)
union
(
SELECT convert(nvarchar(40),RetNum) as Name,
	   COUNT(RetNum) AS Total
FROM dbo.SourceData_28_Beijing BJ
	INNER JOIN dbo.UseSite US
		ON BJ.SiteSysNo=US.SysNo
WHERE (RetTime BETWEEN :START_DATE AND :END_DATE)
	AND US.SysNo=:SiteSysNo
GROUP BY RetNum
)
  ]]>
  </sql>
  <sql name="QueryTrend3">
    <![CDATA[
SELECT *
FROM dbo.SourceData_28_Beijing BJ
	INNER JOIN dbo.UseSite US ON BJ.SiteSysNo=US.SysNo
WHERE (RetTime BETWEEN :START_DATE AND :END_DATE)
	AND US.SysNo=:SiteSysNo
order by BJ.PeriodNum DESC
  ]]>
  </sql>
</Sqls>
