<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <sqls name="QueryNotices" connection="MSSQLWriteService">
    <![CDATA[ 
      SELECT @TotalCount=COUNT(1) FROM Helpmate.dbo.Notices WITH(NOLOCK) #StrWhere#

      SELECT * FROM (
	      SELECT TOP(@EndNumber)
		      *,(ROW_NUMBER() OVER(ORDER BY #SortColumnName#)) AS RowNumber 
	      FROM Helpmate.dbo.Notices WITH(NOLOCK) #StrWhere# ) Result 
      WHERE RowNumber > @StartNumber]]>
  </sqls>

  <sqls name="ChangeNoticesStatus" connection="MSSQLWriteService">
    <![CDATA[ 
      UPDATE Helpmate.dbo.Notices WITH(NOLOCK) 
      SET [Status]=@Status 
      WHERE [SysNo]=@SysNo
    ]]>
  </sqls>
  
    <sqls name="CreateNotices" connection="MSSQLWriteService">
    <![CDATA[ 
      INSERT INTO [Helpmate].[dbo].[Notices]
             ([Contents]
             ,[Status]
             ,[Rank]
             ,[InDate]
             ,[PublishUser])
       VALUES
             (@Contents
             ,@Status
             ,@Rank
             ,GETDATE()
             ,@PublishUser)
    ]]>
  </sqls>

  <sqls name="UpdateNotices" connection="MSSQLWriteService">
    <![CDATA[ 
      UPDATE [Helpmate].[dbo].[Notices]
         SET [Contents] = @Contents
            ,[Status] = @Status
            ,[Rank] = @Rank
            ,[EditDate] =GETDATE()
            ,[PublishUser] = @PublishUser
       WHERE [SysNo]=@SysNo
    ]]>
  </sqls>
  
</configuration>